{% extends "base.html" %}

{% block title %}Admin - Form Submissions - BharatMiles Global{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header py-5 bg-dark-secondary">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-12">
                <div class="text-center fade-in-up">
                    <h1 class="page-title text-white mb-3">Form Submissions</h1>
                    <p class="page-subtitle text-white-50">Manage contact forms and export inquiries</p>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb justify-content-center bg-transparent">
                            <li class="breadcrumb-item"><a href="{{ url_for('index') }}" class="text-primary-orange">Home</a></li>
                            <li class="breadcrumb-item active text-white-50">Admin</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Contact Submissions -->
<section class="submissions-section py-5">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h2 class="section-title text-white mb-4">
                    <i class="fas fa-envelope me-2 text-primary-orange"></i>Contact Submissions
                </h2>
                
                {% if contact_submissions %}
                    <div class="table-responsive">
                        <table class="table table-dark table-striped">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Company</th>
                                    <th>Phone</th>
                                    <th>Message</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for submission in contact_submissions %}
                                <tr>
                                    <td>{{ submission.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                                    <td>{{ submission.name }}</td>
                                    <td>{{ submission.email }}</td>
                                    <td>{{ submission.company or '-' }}</td>
                                    <td>{{ submission.phone or '-' }}</td>
                                    <td>{{ submission.message[:100] }}{% if submission.message|length > 100 %}...{% endif %}</td>
                                    <td>
                                        {% if submission.is_read %}
                                            <span class="badge bg-success">Read</span>
                                        {% else %}
                                            <span class="badge bg-warning">Unread</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>No contact submissions yet.
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Export Inquiries -->
<section class="inquiries-section py-5 bg-dark-secondary">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h2 class="section-title text-white mb-4">
                    <i class="fas fa-shipping-fast me-2 text-primary-orange"></i>Export Inquiries
                </h2>
                
                {% if export_inquiries %}
                    <div class="table-responsive">
                        <table class="table table-dark table-striped">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Company</th>
                                    <th>Product</th>
                                    <th>Quantity</th>
                                    <th>Destination</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for inquiry in export_inquiries %}
                                <tr>
                                    <td>{{ inquiry.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                                    <td>{{ inquiry.name }}</td>
                                    <td>{{ inquiry.email }}</td>
                                    <td>{{ inquiry.company or '-' }}</td>
                                    <td>{{ inquiry.product_category }}</td>
                                    <td>{{ inquiry.quantity or '-' }}</td>
                                    <td>{{ inquiry.destination_country or '-' }}</td>
                                    <td>
                                        {% if inquiry.status == 'pending' %}
                                            <span class="badge bg-warning">Pending</span>
                                        {% elif inquiry.status == 'processing' %}
                                            <span class="badge bg-info">Processing</span>
                                        {% elif inquiry.status == 'completed' %}
                                            <span class="badge bg-success">Completed</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>No export inquiries yet.
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Statistics -->
<section class="stats-section py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="stat-card bg-dark-card p-4 text-center card-hover">
                    <i class="fas fa-envelope fa-2x text-primary-orange mb-3"></i>
                    <h3 class="text-white">{{ contact_submissions|length }}</h3>
                    <p class="text-white-50">Contact Forms</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="stat-card bg-dark-card p-4 text-center card-hover">
                    <i class="fas fa-shipping-fast fa-2x text-primary-orange mb-3"></i>
                    <h3 class="text-white">{{ export_inquiries|length }}</h3>
                    <p class="text-white-50">Export Inquiries</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="stat-card bg-dark-card p-4 text-center card-hover">
                    <i class="fas fa-clock fa-2x text-primary-orange mb-3"></i>
                    <h3 class="text-white">{{ (contact_submissions|selectattr('is_read', 'equalto', false)|list|length) + (export_inquiries|selectattr('is_read', 'equalto', false)|list|length) }}</h3>
                    <p class="text-white-50">Unread Items</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="stat-card bg-dark-card p-4 text-center card-hover">
                    <i class="fas fa-chart-line fa-2x text-primary-orange mb-3"></i>
                    <h3 class="text-white">{{ contact_submissions|length + export_inquiries|length }}</h3>
                    <p class="text-white-50">Total Submissions</p>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
.table-dark {
    background-color: var(--dark-card);
    border: 1px solid var(--border-color);
}

.table-dark th,
.table-dark td {
    border-color: var(--border-color);
}

.table-striped > tbody > tr:nth-of-type(odd) > td {
    background-color: rgba(255, 255, 255, 0.02);
}

.stat-card {
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.stat-card:hover {
    border-color: var(--primary-orange);
    transform: translateY(-5px);
}
</style>
{% endblock %}